# -*- coding: utf-8 -*-

from rsa import rsa_encrypt, rsa_decrypt

if __name__ == "__main__":
    # Barrio's keys
    barrio_n = 26048554081918254772402396727078703502465630597557533117266018789540485475780747197584786190583271659321248729334208524047445737010919616936750858444125060319935027986793977486364471226442713933107427185696864514440603036987197122052742572277872232336254534169638265140240086157981444129651777094261637305372368382906823741917018463938809736866185156571482505798855621207493962046944957554996630201900999421476673956674245683880443049677156075409792647550985559524417635425479290915851823838059536484410257318950869021661885086295099873576476184621848777021277715499350226940503299366676306029946602286741170650381573
    barrio_e = 1048577
    barrio_d = 8218963619372557692910370685173757588806314476154927055346147062692628868106979050480147553042701294258555913965003579706731615304872009497402570357690150038548569994847074692005125073514891887001582620296057436250940461209132130711806558338852162323715363906602146812469387546685152118712836305956216115513645166176160379367790213854735464555181558968349118536807805876492651728335836742969901477132995724698537002827984322378797787447850240094657238846651355786074423434055493367106343372549149380884766894995811542324153769768606840351719414615414942624596654342120645031125422052336590868754335171446733398575793
    
    # de la Hera's keys
    delahera_n = 102177145502170449647535015823292055188749752771393005649892105979200067597554948297407387457859709511918845152650987194391543702482122356296402530264892095093397819813676815413255338683528599712279533202539803336778869663204648825602128229440285623432111299318482515655843275628377999479423128550587755875503
    delahera_e = 65537
    delahera_d = 17208298266325988952571337368960832188623607980442350120705618501692490442162637011651952928363009349494243761117922260068307423533979668090110058864439114949608358158668299897624131119416547961751622408610791793739698108332224032333596259924479570716158944433163524524645330628485919309011531489979608391873
    
    # Mensaje de Barrio a de la Hera
    message_barrio = "P: Hello, De La Hero! How are you?"
    enc_barrio = message_barrio.encode("utf-16") # Cambiar a utf-8 en el próximo mensaje
    encrypted_barrio = rsa_encrypt(enc_barrio, delahera_n, delahera_e)
    decrypted_barrio = rsa_decrypt(encrypted_barrio, delahera_n, delahera_d)
    
    print("Mensaje original para de la Hera:", message_barrio)
    print("Mensaje descifrado:", decrypted_barrio.decode("utf-16"))
    
    # Mensaje de de la Hera a Barrio
    message_delahera = "P: Hello, Barrio! How are you?"
    enc_delahera = message_delahera.encode("utf-16") # Cambiar a utf-8 en el próximo mensaje
    encrypted_delahera = rsa_encrypt(enc_delahera, barrio_n, barrio_e)
    decrypted_delahera = rsa_decrypt(encrypted_delahera, barrio_n, barrio_d)
    
    print("Mensaje original para Barrio:", message_delahera)
    print("Mensaje descifrado:", decrypted_delahera.decode("utf-16"))


